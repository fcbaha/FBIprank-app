<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div class="form-wrapper">
    <h1>üöÄ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ</h1>
    <form id="regForm">
      <input type="text" name="name" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" required />
      <input type="email" name="email" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email" required />
      <button type="submit">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
    </form>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
  <div class="modal" id="loadingModal">
    <div class="modal-content">
      <div class="spinner"></div>
      <p id="statusText">–ù–∞—á–∏–Ω–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É...</p>
    </div>
  </div>

  <script>
    const form = document.getElementById('regForm');
    const modal = document.getElementById('loadingModal');
    const statusText = document.getElementById('statusText');

    const steps = [
      "üîç –°–∫–∞–Ω–∏—Ä—É–µ–º —Ç–≤–æ–∏ —Å–æ—Ü—Å–µ—Ç–∏...",
      "üì¶ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–æ—Ç–æ –∏–∑ Telegram...",
      "üçë –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å 18+ —Å–∞–π—Ç–æ–≤...",
      "üíæ –î–æ—Å—Ç–∞—ë–º –∞—Ä—Ö–∏–≤—ã –±—Ä–∞—É–∑–µ—Ä–∞...",
      "üß† –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –º—ã—Å–ª–∏ –∑–∞ 2020 –≥–æ–¥...",
      "üì® –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤—Å—ë –º–∞–º–µ –∏ –§–ë–†...",
      "‚úÖ –ì–æ—Ç–æ–≤–æ! –ü—Ä–æ–≤–µ—Ä—å –ø–æ—á—Ç—É, –æ—Å–æ–±–µ–Ω–Ω–æ –ø–∞–ø–∫—É ¬´–°–ø–∞–º¬ª üòà"
    ];

    form.addEventListener('submit', (e) => {
      e.preventDefault();

      const formData = new FormData(form);
      const data = new URLSearchParams(formData);

      modal.style.display = 'flex';
      let i = 0;

      const interval = setInterval(() => {
        if (i < steps.length) {
          statusText.innerText = steps[i++];
        } else {
          clearInterval(interval);

          // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º—É
          fetch('/send', {
            method: 'POST',
            body: data
          }).then(() => {
            // –æ—Å—Ç–∞–≤–∏–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
          }).catch(err => {
            statusText.innerText = "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ...";
            console.error(err);
          });
        }
      }, 1500);
    });
  </script>
</body>
</html>
